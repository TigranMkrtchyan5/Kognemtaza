{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kognem — Start</title>
<style>
:root{
  --green-500:#2ecc71;
  --green-600:#27ae60;
  --glass: rgba(255,255,255,0.35);
  --glass-border: rgba(255,255,255,0.55);
  --text-dark:#0f2a1f;
  --text-lux:#fff;
}
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;font-family:"Inter","Segoe UI",Roboto,sans-serif;background:#ffe8d0;}
#cityCanvas{position:fixed;inset:0;width:100%;height:100%;z-index:0;display:block;}
.wrap{position: relative; z-index:2; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:20px;}
.glass{width:min(500px,94%); border-radius:25px; padding:48px; background:var(--glass); border:1px solid var(--glass-border); backdrop-filter: blur(14px) saturate(120%); text-align:center; color:var(--text-dark); box-shadow:0 25px 60px rgba(0,0,0,0.15);}
.brand h1{font-size:44px; font-weight:900; letter-spacing:3px; margin:0; color:#fff; text-shadow:0 4px 10px rgba(0,0,0,0.35);}
.tag{margin-top:12px; font-size:20px; color:#f0f0f0; font-weight:600; text-shadow:0 2px 8px rgba(0,0,0,0.25);}
.actions{margin-top:30px; display:flex; flex-direction:column; gap:16px;}
.btn{border-radius:16px;padding:16px 20px;font-weight:700;font-size:18px;border:0;cursor:pointer;transition:0.2s;}
.btn-primary{background:linear-gradient(90deg,var(--green-500),var(--green-600));color:white;box-shadow:0 12px 28px rgba(39,174,96,0.3);}
.btn-primary:hover{transform:translateY(-2px);}
.btn-ghost{background:transparent; border:2px solid rgba(255,255,255,0.25); color:var(--text-lux);}
.btn-ghost:hover{background: rgba(255,255,255,0.05);}
.guest{margin-top:12px; color:var(--green-600); font-weight:700; display:inline-block; font-size:18px; text-decoration:none; transition:0.2s; cursor:pointer;}
.guest:hover{text-decoration:underline;}
@media(max-width:480px){.glass{padding:28px;border-radius:18px;}.brand h1{font-size:34px;}.tag{font-size:16px;}.btn{font-size:16px;padding:14px 18px;}.guest{font-size:16px;}}
</style>
</head>
<body>

<canvas id="cityCanvas" aria-hidden="true"></canvas>

<div class="wrap" role="main" aria-labelledby="kognemTitle">
  <div class="glass" role="region" aria-label="Welcome">
    <div class="brand">
      <h1 id="kognemTitle">Kognem</h1>
    </div>
    <div class="tag">Own your city. Achieve your goals. Connect. Succeed.</div>

    <div class="actions">
      <a href="{% url 'login' %}"><button class="btn btn-primary">Login</button></a>
      <a href="{% url 'register' %}"><button class="btn btn-ghost">Register</button></a>
      <span class="guest" id="guest-btn">Continue as Guest →</span>
    </div>
  </div>
</div>

<script>
(function(){
const canvas=document.getElementById('cityCanvas');
const ctx=canvas.getContext('2d');
let W,H,DPR;
function resize(){DPR=Math.max(1,window.devicePixelRatio||1); W=window.innerWidth; H=window.innerHeight; canvas.width=W*DPR; canvas.height=H*DPR; canvas.style.width=W+'px'; canvas.style.height=H+'px'; ctx.setTransform(DPR,0,0,DPR,0,0);}
window.addEventListener('resize',resize);
resize();

const rand=(a,b)=>Math.random()*(b-a)+a;

let skyscrapers=[],cars=[],people=[],clouds=[];
let worker={x:0,poleTop:0,poleBottom:0,arm:0,dir:1};

function initSkyscrapers(){skyscrapers=[]; for(let i=0;i<5;i++){let w=rand(80,140),h=rand(H*0.5,H*0.85); skyscrapers.push({x:i*(W/5)+rand(-30,30),w:w,h:h,y:H*0.78-h,shade:0.2});}}
function spawnCars(){cars=[]; const roadY=H*0.78; for(let i=0;i<8;i++){const dir=Math.random()<0.5?1:-1; const w=rand(70,120); cars.push({x:rand(-400,W+400),y:roadY+(dir===1?-8:8),w:w,h:w*0.36,dir,speed:dir*rand(1.5,3)});}}
function spawnPeople(){people=[]; const sidewalkY=H*0.72; for(let i=0;i<12;i++){const dir=Math.random()<0.5?1:-1; people.push({x:rand(-300,W+300),y:sidewalkY+rand(-6,6),size:rand(14,22),speed:dir*rand(0.6,1.3),dir,step:Math.random()*Math.PI*2});}}
function spawnClouds(){clouds=[]; for(let i=0;i<4;i++) clouds.push({x:rand(-200,W+200),y:rand(30,H*0.3),s:rand(0.6,1.3),speed:rand(0.1,0.45)});}
function resetWorker(){worker.x=W*0.12; worker.poleTop=H*0.54; worker.poleBottom=H*0.68; worker.arm=0; worker.dir=1;}
function initScene(){initSkyscrapers(); spawnCars(); spawnPeople(); spawnClouds(); resetWorker();}
initScene();

function drawSky(){const g=ctx.createLinearGradient(0,0,0,H*0.6); g.addColorStop(0,'#ffd6a8'); g.addColorStop(0.5,'#ffb573'); g.addColorStop(1,'#c18bff'); ctx.fillStyle=g; ctx.fillRect(0,0,W,H*0.6);}
function drawSkyscraper(s){ctx.fillStyle='rgba(0,0,0,0.85)'; ctx.fillRect(s.x,s.y,s.w,s.h); for(let wx=s.x+6;wx<s.x+s.w-6;wx+=16){for(let wy=s.y+10;wy<s.y+s.h-8;wy+=20){if(((wx+wy)%50)<25) ctx.fillStyle='rgba(255,255,200,0.15)',ctx.fillRect(wx,wy,6,10)}}}
function drawCar(c){ctx.save(); ctx.translate(c.x,c.y); if(c.dir<0) ctx.scale(-1,1); const w=c.w,h=c.h,bodyH=h*0.7,roofH=h*0.42; ctx.fillStyle='rgba(8,12,10,0.9)'; roundRect(ctx,-w*0.5,-bodyH,w,bodyH,6); ctx.fill(); ctx.fillStyle='rgba(255,255,255,0.04)'; roundRect(ctx,-w*0.18,-bodyH-roofH,w*0.36,roofH,4); ctx.fill(); ctx.fillStyle='#050505'; ctx.beginPath(); ctx.arc(-w*0.22,4,h*0.45,0,Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.arc(w*0.22,4,h*0.45,0,Math.PI*2); ctx.fill(); ctx.restore();}
function drawPerson(p,t){ctx.save(); ctx.translate(p.x,p.y); if(p.dir<0) ctx.scale(-1,1); const step=Math.sin(p.step+t*0.006)*0.9,torsoH=p.size; ctx.fillStyle='#0e2a21'; roundRect(ctx,-p.size*0.28,-torsoH-6,p.size*0.56,torsoH,4); ctx.fill(); ctx.beginPath(); ctx.arc(0,-torsoH-12,p.size*0.36,0,Math.PI*2); ctx.fillStyle='#f6e9db'; ctx.fill(); ctx.restore();}
function drawWorker(dt){const poleX=worker.x,poleTop=worker.poleTop,poleBottom=worker.poleBottom; worker.arm+=0.02*worker.dir*dt; if(worker.arm>0.8) worker.dir=-1; if(worker.arm<-0.3) worker.dir=1; ctx.save(); ctx.strokeStyle='#0b231b'; ctx.lineWidth=4; ctx.beginPath(); ctx.moveTo(poleX,poleTop); ctx.lineTo(poleX,poleBottom); ctx.stroke(); ctx.restore();}
function roundRect(ctx,x,y,w,h,r){const rad=Math.min(r,Math.abs(w/2),Math.abs(h/2)); ctx.beginPath(); ctx.moveTo(x+rad,y); ctx.arcTo(x+w,y,x+w,y+h,rad); ctx.arcTo(x+w,y+h,x,y+h,rad); ctx.arcTo(x,y+h,x,y,rad); ctx.arcTo(x,y,x+w,y,rad); ctx.closePath();}

let lastTime=performance.now();
function loop(now){const dt=now-lastTime; lastTime=now; ctx.clearRect(0,0,W,H); drawSky(); skyscrapers.forEach(s=>drawSkyscraper(s)); const roadY=H*0.78; ctx.fillStyle='#0b1a16'; ctx.fillRect(0,roadY,W,H-roadY); cars.forEach(c=>{c.x+=c.speed*dt*0.03;if(c.dir>0&&c.x-c.w*0.5>W+120)c.x=-120;if(c.dir<0&&c.x+c.w*0.5<-160)c.x=W+120; drawCar(c);}); people.forEach(p=>{p.x+=p.speed*dt*0.02;p.step+=0.08*dt*Math.abs(p.speed);if(p.dir>0&&p.x>W+80)p.x=-80;if(p.dir<0&&p.x<-80)p.x=W+80; drawPerson(p,now);}); drawWorker(dt); requestAnimationFrame(loop);}
requestAnimationFrame(loop);

// Guest button logic
document.getElementById('guest-btn').addEventListener('click', () => {
    fetch("{% url 'logout' %}", {method: 'GET', credentials: 'same-origin'})
    .then(() => { window.location.href = "{% url 'home' %}"; });
});
})();
</script>

</body>
</html>
